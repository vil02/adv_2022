"""tests of adv_2022_10"""

import pytest
import solutions.adv_2022_10 as sol
from . import test_utils as tu

_INPUTS = tu.get_inputs(10, {"small", "bigger", "p", "s", "b"})

_DATA_SMALL = _INPUTS.inputs["small"]
assert _DATA_SMALL is not None


def test_run():
    """tests run method of the Computer with small example data"""
    cmds = sol.parse_input(_DATA_SMALL)
    computer = sol.Computer()
    computer.run(cmds)
    assert computer.saved_cycles == [1, 1, 1, 1, 4, 4, -1]


@pytest.mark.parametrize(
    "input_cycle,input_x,expected",
    [
        (20, 21, 420),
        (60, 19, 1140),
        (100, 18, 1800),
        (140, 21, 2940),
        (180, 16, 2880),
        (220, 18, 3960),
    ],
)
def test_signal_strength(input_cycle, input_x, expected):
    """tests signal_strength"""
    assert sol.signal_strength(input_cycle, input_x) == expected


_EXPECTED_BIGGER = [
    """##..##..##..##..##..##..##..##..##..##..""",
    """###...###...###...###...###...###...###.""",
    """####....####....####....####....####....""",
    """#####.....#####.....#####.....#####.....""",
    """######......######......######......####""",
    """#######.......#######.......#######.....""",
]

_EXPECTED_P = [
    """###..#....####.####.####.#.....##..####.""",
    """#..#.#....#.......#.#....#....#..#.#....""",
    """#..#.#....###....#..###..#....#....###..""",
    """###..#....#.....#...#....#....#.##.#....""",
    """#.#..#....#....#....#....#....#..#.#....""",
    """#..#.####.####.####.#....####..###.####.""",
]

_EXPECTED_S = [
    """####.###...##..###..#..#.####..##..#..#.""",
    """#....#..#.#..#.#..#.#..#.#....#..#.#..#.""",
    """###..#..#.#....#..#.####.###..#....####.""",
    """#....###..#.##.###..#..#.#....#.##.#..#.""",
    """#....#....#..#.#....#..#.#....#..#.#..#.""",
    """#....#.....###.#....#..#.#.....###.#..#.""",
]

_EXPECTED_B = [
    "###..###....##.#....####.#..#.#....###..",
    "#..#.#..#....#.#....#....#..#.#....#..#.",
    "###..#..#....#.#....###..#..#.#....#..#.",
    "#..#.###.....#.#....#....#..#.#....###..",
    "#..#.#.#..#..#.#....#....#..#.#....#....",
    "###..#..#..##..####.#.....##..####.#....",
]

test_solve_a, test_solve_b = _INPUTS.get_tests(
    (sol.solve_a, sol.solve_b),
    {
        "bigger": (13140, _EXPECTED_BIGGER),
        "p": (17020, _EXPECTED_P),
        "s": (10760, _EXPECTED_S),
        "b": (12980, _EXPECTED_B),
    },
)
